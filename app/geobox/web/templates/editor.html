{% extends "base_map.html" %}
{% block title %}{{ _('editor') }}{% endblock %}

{% block project_js %}
  <!-- JSTS for split and union -->
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/javascript.util.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/jsts.js') }}"></script>

  <!-- Proj4 for transformation -->
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/proj4js-compressed.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/proj4js.defs.js') }}"></script>

  <!-- slider and colorpicker for styleeditor -->
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/jquery.nouislider.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/lib/widgets/jquery.minicolor.js') }}"></script>

  <!-- widgets -->
   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/layermanager.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/measure.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/attribute.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/styleeditor.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/pointstyleeditor.js') }}"></script>

   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/filter.js') }}"></script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/widgets/thematicalvector.js') }}"></script>

{% endblock %}

{% block map_js %}

    <script type="text/javascript">
      OpenLayers.ProxyHost = "{{ url_for('proxy.proxy_request') }}";

      {{ generate_base_layer(base_layer) }}
      {{ generate_sources(sources, cache_url, False)}}

      {{ generate_couch_layers(couch_layers)}}

  </script>
   <script type="text/javascript" src="{{ url_for('static', filename='js/views/editor.js') }}"></script>
{% endblock %}

{% block content %}
<div class="row-fluid">
    <h1>{{_('editor')}}
      {{ generate_tooltip(_('tooltip - editor') ) }}
    </h1>

    <div class="span8 map" id='map'></div>
    <div class="span4">
      <div class="bs-docs-example">
        <ul id="tabs" class="nav nav-tabs">
          <li class="active">
            <a href="#layermanager" data-toggle="tab">{{ _('manager') }}</a>
          </li>
          <li>
            <a href="#layer" data-toggle="tab">{{ _('layer') }}</a>
          </li>
          <li>
            <a href="#edit" data-toggle="tab">{{ _('edit') }}</a>
          </li>
          <li>
            <a href="#filter" data-toggle="tab">{{ _('filter') }}</a>
          </li>
          <li>
            <a href="#measure" data-toggle="tab">{{ _('measure') }}</a>
          </li>
          <li>
            <a href="#thematical" data-toggle="tab">{{ _('thematical map') }}</a>
          </li>
          <li>
            <a href="#legend" data-toggle="tab">{{ _('thematical legend') }}</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane fade in active" id="layermanager">
          <!-- load layermanager widget -->
          </div>

          <div class="tab-pane fade" id="layer">
            <h4>{{ _('Styling') }}</h4>
            <p>{{ _('infotext - edit styling') }}</p>
            <div id="style-editor"></div>
          </div>

          <div class="tab-pane fade" id="edit">
            <h4>{{ _('Edit') }}</h4>
            <p>{{ _('infotext - edit controls') }}</p>
            <div id="edit-toolbar" class="span12">
            </div>

            <div class="span12">
              <button id="select_all_features" class="btn btn-small">{{ _('select all features') }}</button>
            </div>
            <hr id="save_dividing_line" class="span12">
            <button id="save_changes" class="btn btn-small"  disabled="disabled">
              {{ _('save permanent') }}</button>
            <hr>

           <div>
            <ul id="editor-tabs" class="nav nav-tabs">
              <li class="active">
                  <a id="attributeTab" href="#attributes" data-toggle="tab">
                    {{ _('Attribute') }}</a>
                </li>
                <li>
                  <a id="pointTab" href="#point_stling" data-toggle="tab" style="display:none">{{ _('point styling') }}</a>
                </li>
            </ul>
              <div class="tab-content">
                <div class="tab-pane fade in active" id="attributes">
                  <h4>{{ _('Attributes') }}</h4>
                  <p>{{ _('infotext - attributes') }}</p>
                  <div id="attributemanager"></div>
                </div>
                <div class="tab-pane fade" id="point_stling">
                  <div id="point-style-editor"></div>
                </div>
             </div>
            </div>
          </div>
          <div class="tab-pane fade" id="filter">
            <h4>{{ _('filter') }}</h4>
            <p>{{ _('infotext - filter controls') }}</p>
            <div id="filtermanager"></div>
          </div>

          <div class="tab-pane fade" id="measure">
            <h4>{{ _('Measure') }}</h4>
            <p>{{ _('infotext - measure controls') }}</p>
            <div id="measure-toolbar">
            <!--  load measure widget -->
            </div>
            <div id="measure-output">
            </div>
          </div>

          <div class="tab-pane fade" id="thematical">
            <h4>{{ _('thematical map') }}</h4>
            <p>{{ _('infotext - thematical map') }}</p>
            <div id="thematical-vector"></div>
          </div>

          <div class="tab-pane fade" id="legend">
            <h4>{{ _('thematical legend') }}</h4>
            <p>{{ _('infotext - thematical legend') }}</p>
            <div id="thematical-legend"></div>
          </div>
        </div>
      </div>
    </div>


  <!-- modals for delete -->
   <div id="deleteVectorLayer" class="modal hide">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      <h3>{{_('Sure you want delete layer')}} <span id="layer_title"></span>?</h3>
    </div>
    <div class="modal-body">
      <p>{{ _('infotext delete layer') }}</p>
    </div>
    <div class="modal-footer">
      <a href="#" id="abort_remove_layer" class="btn" data-dismiss="modal">{{_('abort')}}</a>
      <a href="#" id="remove_layer" class="btn btn-primary">{{_('yes delete')}}</a>
    </div>
  </div>

</div>

{% endblock %}
